# At the moment this code is for copy and paste into terminal for linux 9 to setup repos and install
# Cockpit, Virt, Go, Snapd, Kubernetes tools (kubeadm, kubectl, kind, minikube), Container-tools, Flatpak, 
# Podman Desktop, VS Code all W/O disabling Selinux or Secure Boot. 

sudo dnf -y install epel-release
cat <<EOF | sudo tee /etc/yum.repos.d/kubernetes.repo
[kubernetes]
name=Kubernetes
baseurl=https://pkgs.k8s.io/core:/stable:/v1.32/rpm/
enabled=1
gpgcheck=1
gpgkey=https://pkgs.k8s.io/core:/stable:/v1.32/rpm/repodata/repomd.xml.key
EOF
sudo rpm --import https://packages.microsoft.com/keys/microsoft.asc
echo -e "[code]\nname=Visual Studio Code\nbaseurl=https://packages.microsoft.com/yumrepos/vscode\nenabled=1\nautorefresh=1\ntype=rpm-md\ngpgcheck=1\ngpgkey=https://packages.microsoft.com/keys/microsoft.asc" | sudo tee /etc/yum.repos.d/vscode.repo > /dev/null
sudo dnf install -y cockpit-machines qemu-kvm libvirt virt-install virt-viewer go snapd container-tools kubelet kubeadm kubectl flatpak
sudo dnf update -y
systemctl restart snapd.service && systemctl restart snapd.seeded.service
for drv in qemu network nodedev nwfilter secret storage interface; do systemctl start virt${drv}d{,-ro,-admin}.socket; done 
virt-host-validate
sudo ln -s /var/lib/snapd/snap /snap
go install sigs.k8s.io/kind@v0.27.0 
sudo mv ~/go/bin/kind /bin && sudo rm -r ~/go 
curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-latest.x86_64.rpm
sudo rpm -Uvh minikube-latest.x86_64.rpm && sudo rm -r minikube-latest.x86_64.rpm
systemctl enable --now cockpit.socket snapd.socket grafana-server.service kubelet
flatpak remote-add --if-not-exists --user flathub https://flathub.org/repo/flathub.flatpakrepo
flatpak install -y --user flathub io.podman_desktop.PodmanDesktop 
flatpak update -y --user io.podman_desktop.PodmanDesktop
sudo snap install code-insiders --classic
snap run code-insiders
flatpak run io.podman_desktop.PodmanDesktop


** Either log out and back in or restart for changes to fully take effect **


# Working on -
Changing the use of the Snapd daemon to handle VS code updates
Install Docker Compose script and add it to path
Pull, Start and Exit coretinth IT tools and have browser open to 
localhost:9090 (Cockpit/Prometheus) 
localhost:8080 (IT tools)
